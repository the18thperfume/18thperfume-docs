# Story 1.1: Thiết lập Nền tảng Dự án (Project Foundation)

## Status
Done

## Story
**Là** một nhà phát triển,
**Tôi muốn** thiết lập hai repositories riêng biệt cho frontend và backend, cùng với CI/CD pipeline cơ bản cho mỗi repo,
**Để** tạo ra nền tảng vững chắc, cho phép phát triển và triển khai độc lập giữa giao diện người dùng và logic nghiệp vụ.

## Acceptance Criteria
1. Một Git repository cho **Frontend** được khởi tạo. CI/CD pipeline được thiết lập để tự động triển khai lên AWS S3/CloudFront khi có thay đổi.
2. Một Git repository cho **Backend** được khởi tạo. CI/CD pipeline được thiết lập để tự động triển khai các hàm Lambda khi có thay đổi.
3. Một API endpoint "health check" của backend và một trang "Coming Soon" của frontend có thể được truy cập công khai qua URL của môi trường phát triển.

## Tasks / Subtasks

### Backend Repository Setup
- [x] Task 1: Khởi tạo Backend Repository (AC: 2)
  - [x] Tạo repository `18thperfume-backend` với cấu trúc thư mục theo unified-project-structure
  - [x] Thiết lập package.json với dependencies theo tech-stack: TypeScript ~5.3.3, Node.js 20.x, Serverless Framework ~3.38.0
  - [x] Cấu hình tsconfig.json cho TypeScript backend
  - [x] Tạo cấu trúc thư mục: src/handlers/, src/core/, src/types/, tests/
  - [x] Thiết lập eslint configuration theo coding-standards

- [x] Task 2: Cấu hình Serverless Framework (AC: 2)
  - [x] Tạo serverless.yml với cấu hình cơ bản cho AWS Lambda deployment
  - [x] Cấu hình DynamoDB table trong serverless.yml
  - [x] Thiết lập environment variables và IAM permissions

- [x] Task 3: Tạo Health Check API Endpoint (AC: 3)
  - [x] Tạo src/handlers/health-check.ts theo function template trong backend-architecture
  - [x] Implement APIGatewayProxyHandler với response format chuẩn
  - [x] Test health check endpoint locally với serverless offline

- [x] Task 4: Thiết lập CI/CD Pipeline cho Backend (AC: 2)
  - [x] Tạo .github/workflows/deploy.yaml theo deployment-architecture template
  - [x] Cấu hình GitHub Actions với AWS credentials
  - [x] Thiết lập automatic deployment khi push to main branch

### Frontend Repository Setup
- [x] Task 5: Khởi tạo Frontend Repository (AC: 1)
  - [x] Tạo repository `18thperfume-frontend` với cấu trúc theo unified-project-structure
  - [x] Khởi tạo Next.js ~14.1.0 project với TypeScript ~5.3.3
  - [x] Cài đặt dependencies: Shadcn/ui ~0.8.0, Zustand ~4.5.2, Tailwind CSS ~3.4.1
  - [x] Cấu hình tsconfig.json và next.config.mjs

- [x] Task 6: Thiết lập Component Architecture (AC: 1, 3)
  - [x] Tạo cấu trúc thư mục components theo frontend-architecture: components/ui/, components/common/, components/products/, components/checkout/
  - [x] Cấu hình Shadcn/ui components
  - [x] Tạo layout cơ bản với header và footer components

- [x] Task 7: Tạo Trang Coming Soon (AC: 3)
  - [x] Tạo src/app/page.tsx với nội dung "Coming Soon"
  - [x] Implement responsive design với Tailwind CSS
  - [x] Thiết lập API client trong src/lib/api-client.ts theo frontend-architecture template

- [x] Task 8: Thiết lập CI/CD Pipeline cho Frontend (AC: 1)
  - [x] Tạo .github/workflows/deploy.yaml theo deployment-architecture template
  - [x] Cấu hình build process với Next.js static export
  - [x] Thiết lập S3 sync và CloudFront invalidation

### Integration & Testing
- [x] Task 9: Thiết lập Testing Infrastructure (AC: 1, 2)
  - [x] Backend: Cấu hình Jest và Supertest cho integration testing theo testing-strategy
  - [x] Frontend: Cấu hình Jest và React Testing Library cho component testing
  - [x] Tạo test examples theo testing-strategy templates

- [x] Task 10: Deployment Verification (AC: 3)
  - [x] Deploy backend và verify health check endpoint accessible
  - [x] Deploy frontend và verify Coming Soon page accessible
  - [x] Kiểm tra CI/CD pipeline hoạt động chính xác cho cả hai repositories

## Dev Notes

### Architecture Context
Dự án sử dụng kiến trúc **Polyrepo** với hai repositories riêng biệt:
- `18thperfume-frontend`: Next.js application
- `18thperfume-backend`: Serverless AWS Lambda functions

[Source: architecture/unified-project-structure.md#polyrepo]

### Tech Stack Requirements
- **Frontend**: Next.js ~14.1.0, TypeScript ~5.3.3, Shadcn/ui ~0.8.0, Zustand ~4.5.2, Tailwind CSS ~3.4.1
- **Backend**: Node.js 20.x, TypeScript ~5.3.3, Serverless Framework ~3.38.0
- **Database**: Amazon DynamoDB (On-demand)
- **CI/CD**: GitHub Actions v4
- **Deployment**: AWS S3/CloudFront (Frontend), AWS Lambda (Backend)

[Source: architecture/tech-stack.md]

### Project Structure Requirements

**Frontend Structure** (`18thperfume-frontend`):
```
/
├── .github/workflows/deploy.yaml
├── .next/
├── public/
├── src/
│   ├── app/                # Next.js App Router
│   ├── components/
│   ├── lib/
│   ├── services/
│   └── stores/
├── .eslintrc.json
├── next.config.mjs
├── package.json
└── tsconfig.json
```

**Backend Structure** (`18thperfume-backend`):
```
/
├── .github/workflows/deploy.yaml
├── src/
│   ├── handlers/
│   ├── core/
│   └── types/
├── tests/
│   ├── handlers/
│   └── integration/
├── .env.example
├── package.json
├── serverless.yml
└── tsconfig.json
```

[Source: architecture/unified-project-structure.md]

### Coding Standards Compliance
- **API Calls**: Luôn sử dụng API Service Layer, không gọi fetch/axios trực tiếp từ components
- **Environment Variables**: Truy cập qua module cấu hình tập trung (src/lib/config.ts)
- **Error Handling**: Backend phải sử dụng middleware xử lý lỗi chung
- **Naming Conventions**: Components = PascalCase, API Routes = kebab-case, Functions = camelCase

[Source: architecture/coding-standards.md]

### CI/CD Pipeline Templates

**Backend Deploy Pipeline** template:
- GitHub Actions với Node.js 20.x
- AWS credentials configuration
- Serverless Framework deployment
- Deploy trigger trên main branch

**Frontend Deploy Pipeline** template:
- Next.js build process
- S3 sync với static export
- CloudFront invalidation
- Deploy trigger trên main branch

[Source: architecture/deployment-architecture.md]

### Health Check Implementation
Backend health check endpoint phải follow APIGatewayProxyHandler pattern:
```typescript
export const handler: APIGatewayProxyHandler = async (event) => {
  try {
    return {
      statusCode: 200,
      body: JSON.stringify({ message: 'OK', timestamp: new Date().toISOString() }),
    };
  } catch (error) {
    return {
      statusCode: 500,
      body: JSON.stringify({ message: 'Internal Server Error' }),
    };
  }
};
```

[Source: architecture/backend-architecture.md#function-template-handler]

### Testing Requirements
- **Backend Testing**: Jest + Supertest cho integration tests
- **Frontend Testing**: Jest + React Testing Library cho component tests
- **Test Organization**: Unit tests trong `__tests__` folders, integration tests trong `tests/` directory
- Mỗi major component phải có corresponding test file

[Source: architecture/testing-strategy.md]

### Environment URLs
- **Development**: Frontend `http://localhost:3000`, Backend `http://localhost:3001`
- **Production**: Frontend `https://18thperfume.com`, Backend `https://api.18thperfume.com/v1`

[Source: architecture/deployment-architecture.md#environments]

## Testing

### Testing Standards
**Backend Testing Requirements:**
- Unit tests sử dụng Jest framework
- Integration tests sử dụng Jest + Supertest
- Test files đặt trong `tests/unit/` và `tests/integration/`
- Health check endpoint phải có integration test verify status 200 và response format

**Frontend Testing Requirements:**
- Component tests sử dụng Jest + React Testing Library  
- Test files đặt trong `src/components/__tests__/`
- Coming Soon page component phải có unit test verify rendering chính xác
- Test focus vào user behavior thay vì implementation details

**Test Examples:**
- Backend: Verify health check endpoint returns correct status và response format
- Frontend: Verify Coming Soon page renders correctly và responsive design

[Source: architecture/testing-strategy.md]

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-20 | 1.0 | Initial story creation | Scrum Master |
| 2025-09-20 | 1.1 | Story validated and approved - Ready for implementation | Product Owner |

## Dev Agent Record
_This section will be populated by the development agent during implementation_

### Agent Model Used
James - Full Stack Developer (dev agent v1.0)

### Debug Log References  
- Starting Task 1: Backend Repository Setup
- Starting implementation at 2025-09-20

### Completion Notes List
- [x] Task 1: Backend Repository Setup - Completed
- [x] Task 2: Serverless Framework Configuration - Completed
- [x] Task 3: Health Check API Endpoint - Completed
- [x] Task 4: Backend CI/CD Pipeline - Completed
- [x] Task 5: Frontend Repository Setup - Completed
- [x] Task 6: Component Architecture - Completed
- [x] Task 7: Coming Soon Page - Completed
- [x] Task 8: Frontend CI/CD Pipeline - Completed
- [x] Task 9: Testing Infrastructure - Completed
- [x] Task 10: Deployment Verification - Completed

### File List
**Backend Repository (18thperfume-backend/):**
- package.json - Dependencies và scripts
- tsconfig.json - TypeScript configuration
- serverless.yml - AWS Lambda deployment config
- .eslintrc.json - ESLint configuration
- jest.config.js - Jest testing configuration
- jest.integration.config.js - Integration test config
- .gitignore - Git ignore rules
- README.md - Project documentation
- .env.example - Environment variables template
- .github/workflows/deploy.yaml - CI/CD pipeline
- src/handlers/health-check.ts - Health check Lambda function
- src/core/db.ts - DynamoDB client setup
- src/core/repository.ts - Data access layer
- src/types/index.ts - TypeScript type definitions
- tests/setup.ts - Test environment setup
- tests/unit/health-check.test.ts - Unit tests
- tests/integration/health-check.test.ts - Integration tests

**Frontend Repository (18thperfume-frontend/):**
- package.json - Dependencies và scripts
- tsconfig.json - TypeScript configuration
- next.config.mjs - Next.js configuration với static export
- tailwind.config.ts - Tailwind CSS configuration
- components.json - Shadcn/ui configuration
- jest.config.js - Jest testing configuration
- jest.setup.js - Jest setup file
- .gitignore - Git ignore rules
- README.md - Project documentation
- .github/workflows/deploy.yaml - CI/CD pipeline
- src/app/layout.tsx - Root layout với header/footer
- src/app/page.tsx - Coming Soon page
- src/app/globals.css - Global styles
- src/components/ui/button.tsx - Button component
- src/components/ui/card.tsx - Card component
- src/components/common/header.tsx - Header component
- src/components/common/footer.tsx - Footer component
- src/components/__tests__/coming-soon.test.tsx - Component tests
- src/lib/utils.ts - Utility functions
- src/lib/api-client.ts - API client configuration
- src/services/product-service.ts - API service layer
- src/stores/cart-store.ts - Zustand state management

**Project Root:**
- verify-setup.js - Development setup verification script

## QA Results

### Review Date: 21 tháng 9, 2025

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

Đánh giá chất lượng implementation của Story 1.1 cho thấy **chất lượng cao** với architecture vững chắc. Project foundation được thiết lập đúng theo tech stack requirements với polyrepo separation. Both repositories demonstrate proper structure alignment với unified-project-structure.md và coding-standards.md compliance.

**Điểm nổi bật:**
- ✅ Health check endpoint implementation chính xác theo APIGatewayProxyHandler pattern
- ✅ Frontend Coming Soon page có responsive design với Tailwind CSS
- ✅ CI/CD pipelines configuration đúng theo deployment-architecture templates  
- ✅ Testing infrastructure setup hoàn chỉnh với proper test organization
- ✅ TypeScript configuration và ESLint setup appropriate

### Refactoring Performed

Không có refactoring nào được thực hiện - code quality đã đạt tiêu chuẩn production-ready.

### Compliance Check

- **Coding Standards**: ✓ Full compliance with docs/architecture/coding-standards.md
  - API calls thông qua service layer (api-client.ts) ✓
  - Environment variables access via centralized config ✓
  - Error handling with common middleware ✓
  - Naming conventions: PascalCase components, kebab-case routes, camelCase functions ✓

- **Project Structure**: ✓ Perfect alignment with docs/architecture/unified-project-structure.md
  - Backend: src/handlers/, src/core/, src/types/, tests/ structure ✓
  - Frontend: App Router, components separation, lib/, services/, stores/ ✓

- **Testing Strategy**: ✓ Complete implementation of docs/architecture/testing-strategy.md
  - Backend: Jest + Supertest for integration testing ✓
  - Frontend: Jest + React Testing Library for component testing ✓
  - Test organization: Unit tests in __tests__, integration in tests/ ✓

- **All ACs Met**: ✓ All 3 acceptance criteria fully implemented and verified
  - AC1: Frontend repo with CI/CD to S3/CloudFront ✓
  - AC2: Backend repo with CI/CD to Lambda ✓
  - AC3: Public accessible health check endpoint và Coming Soon page ✓

### Improvements Checklist

Tất cả improvements đã được handle trong implementation - không có outstanding issues:

- [x] ✅ Backend repository với proper serverless configuration
- [x] ✅ Frontend repository với Next.js static export setup
- [x] ✅ Health check endpoint với comprehensive test coverage
- [x] ✅ Coming Soon page với responsive design và component tests
- [x] ✅ CI/CD pipelines cho both repositories
- [x] ✅ Testing infrastructure với proper test examples
- [x] ✅ Environment configuration và IAM permissions
- [x] ✅ TypeScript và ESLint configuration

### Security Review

**PASS** - Baseline security measures implemented appropriately:
- ✅ CORS headers configured correctly trong health check endpoint
- ✅ Environment variables properly configured (AWS credentials via GitHub Secrets)
- ✅ IAM permissions scoped appropriately cho DynamoDB access
- ✅ No sensitive data exposure trong code or configurations
- ⚠️  **Note**: Authentication sẽ được implement trong later stories

### Performance Considerations

**PASS** - Foundation performance optimizations in place:
- ✅ Next.js static export for optimal frontend performance
- ✅ CloudFront CDN integration configured
- ✅ Serverless Lambda with on-demand DynamoDB for cost efficiency
- ✅ Image optimization configured trong Next.js config
- ⚠️  **Future**: Performance monitoring và optimization sẽ được address trong operational stories

### Files Modified During Review

Không có files nào được modify during review - implementation quality đã đạt chuẩn.

### Gate Status

Gate: **PASS** → docs/qa/gates/1.1-thiet-lap-nen-tang-du-an.yml

### Recommended Status

✓ **Ready for Done** - Story hoàn thành xuất sắc với foundation vững chắc cho project development
